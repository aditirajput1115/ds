
class Node:
    def __init__(self, roll, name, marks):
        self.roll = roll
        self.name = name
        self.marks = marks
        self.next = None

class StudentList:
    def __init__(self):
        self.head = None

    
    def add(self, roll, name, marks):
        new = Node(roll, name, marks)
        if self.head is None:
            self.head = new
        else:
            temp = self.head
            while temp.next:
                temp = temp.next
            temp.next = new
        print("Record added.")

    def delete(self, roll):
        temp = self.head
        prev = None
        while temp:
            if temp.roll == roll:
                if prev is None:
                    self.head = temp.next
                else:
                    prev.next = temp.next
                print("Record deleted.")
                return
            prev = temp
            temp = temp.next
        print("Roll not found.")

    def update(self, roll, marks):
        temp = self.head
        while temp:
            if temp.roll == roll:
                temp.marks = marks
                print("Record updated.")
                return
            temp = temp.next
        print("Roll not found.")

    def search(self, roll):
        temp = self.head
        while temp:
            if temp.roll == roll:
                print(f"Roll:{temp.roll}, Name:{temp.name}, Marks:{temp.marks}")
                return
            temp = temp.next
        print("Roll not found.")

    def sort(self, key="marks", order="asc"):
        if self.head is None:
            print("No records.")
            return
        swapped = True
        while swapped:
            swapped = False
            temp = self.head
            while temp.next:
                a = temp.marks if key=="marks" else temp.roll
                b = temp.next.marks if key=="marks" else temp.next.roll
                if (order=="asc" and a > b) or (order=="desc" and a < b):
                    temp.roll, temp.next.roll = temp.next.roll, temp.roll
                    temp.name, temp.next.name = temp.next.name, temp.name
                    temp.marks, temp.next.marks = temp.next.marks, temp.marks
                    swapped = True
                temp = temp.next
        print("Records sorted.")

    def display(self):
        temp = self.head
        if temp is None:
            print("No records.")
            return
        while temp:
            print(f"Roll:{temp.roll}, Name:{temp.name}, Marks:{temp.marks}")
            temp = temp.next



slist = StudentList()

while True:
    print("\n1.Add  2.Delete  3.Update  4.Search  5.Sort  6.Display  7.Exit")
    ch = int(input("Enter choice: "))

    if ch == 1:
        r = int(input("Roll: "))
        n = input("Name: ")
        m = int(input("Marks: "))
        slist.add(r, n, m)

    elif ch == 2:
        r = int(input("Enter Roll to delete: "))
        slist.delete(r)

    elif ch == 3:
        r = int(input("Enter Roll to update: "))
        m = int(input("New Marks: "))
        slist.update(r, m)

    elif ch == 4:
        r = int(input("Enter Roll to search: "))
        slist.search(r)

    elif ch == 5:
        k = input("Sort by (roll/marks): ")
        o = input("Order (asc/desc): ")
        slist.sort(k, o)

    elif ch == 6:
        slist.display()

    elif ch == 7:
        print("Exit...")
        break

    else:
        print("Invalid choice!")
